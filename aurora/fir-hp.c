/*                                                              
MODULE:         FIRFLT, HIGH PASS FIR FILTER, for data sampled at 8khz
                
ORIGINAL BY:
                Simao Ferraz de Campos Neto
		Comsat Laboratories             Tel:    +1-301-428-4516
		22300 Comsat Drive              Fax:    +1-301-428-9287
		Clarksburg MD 20871 - USA       E-mail: simao@ctd.comsat.com

		Rosario Drogo de Iacovo
		CSELT
		Audio Coding and Transmission Quality  Tel: +39-11-228-5697
		Via G.Reiss Romoli, 274                Fax: +39-11-228-6207
		10148 Torino - ITALY     
		Email: rosario.drogodeiacovo@cselt.stet.it


MODIFIED BY : 	Nabil Benameur	
		Matra Nortel Communications
		May 18th, 1998.


FUNCTIONS:
  Global (have prototype in firflt.h)

  Local (should be used only here -- prototypes only in this file)

  Global (have prototype in firflt.h)
         = fir_hp_8khz_init()

  Local (should be used only here -- prototypes only in this file)
         = fill_fir_hp_8khz(...): idem, for Delta-SM filter characteristic


HISTORY:
    31.Jul.95 v1.0 First beta-version <simao@ctd.comsat.com>

  =============================================================================
*/


/*
 * ......... INCLUDES .........
 */
#include <stdio.h>
#ifndef VMS
#include <stdlib.h>		/* General utility definitions */
#endif

#include "firflt.h"		/* Global definitions for FIR-FIR filter */


/*
 * ......... Local function prototypes .........
 */
void fill_fir_hp_8khz ARGS((float **h0, long *lenh0));


/* 
 * ..... Private function prototypes defined in other sub-unit ..... 
 */
extern SCD_FIR *fir_initialization ARGS((long lenh0, float h0[], double gain, 
                                                 long idwnup, int hswitch));


/*
 * ...................... BEGIN OF FUNCTIONS .........................
 */

/*
  ============================================================================

        void fill_fir_hp_8khz (float **h0, long *lenh0);
        ~~~~~~~~~~~~~~~~~~~~~

        Description:
        ~~~~~~~~~~~~
	Fill filter coefficients for a high pass filter for samples at 8 kHz.

        Parameters:
        ~~~~~~~~~~~
        h0:    (Out) pointer to array with FIR coefficients
        lenh0: (Out) pointer to number of coefficients

        Return value:
        ~~~~~~~~~~~~~
        None.

        Author: 
        ~~~~~~~
        Filter coefficients: 
	Nabil Benameur
          ============================================================================
*/
#undef HP_8K_LEN
#define HP_8K_LEN 251
void fill_fir_hp_8khz (float **h0, long *lenh0)
{
 static float hp_8khz_coeff[HP_8K_LEN] ={
 0.00019984355069981700,  0.00020324149375248640,  0.00020712997490214150, 
 0.00021152561920372840,  0.00021643855204390890,  0.00022187211750733480, 
 0.00022782262112960940,  0.00023427909838851350,  0.00024122311020115020, 
 0.00024862856660538220,  0.00025646157970953580,  0.00026468034689519780, 
 0.00027323506515432210,  0.00028206787733416060,  0.00029111285095212080, 
 0.00030029599012787860,  0.00030953528106237000,  0.00031874077137303870, 
 0.00032781468347237000,  0.00033665156205269610,  0.00034513845561499400, 
 0.00035315513185332860,  0.00036057432658018790,  0.00036726202575168100, 
 0.00037307778002584000,  0.00037787505116262120,  0.00038150158945098860, 
 0.00038379984122724620,  0.00038460738542994400,  0.00038375739802067220, 
 0.00038107914298735200,  0.00037639848853759820,  0.00036953844698482680, 
 0.00036031973672939980,  0.00034856136464161210,  0.00033408122706313280, 
 0.00031669672755894550,  0.00029622540947323300,  0.00027248560127034850, 
 0.00024529707257629140,  0.00021448169877723660,  0.00017986413197991390, 
 0.00014127247609420350,  0.00009853896376142904,  0.00005150063282266082, 
 -0.00000000000000000017,  -0.00005611427054948061, 
 -0.00011698670615276900,  -0.00018275437435563430, 
 -0.00025354624380472720,  -0.00032948255958947780, 
 -0.00041067423532885210,  -0.00049722226425247260, 
 -0.00058921715148209200,  -0.00068673836966793720, 
 -0.00078985384007517500,  -0.00089861944114887200, 
 -0.00101307854651154700,  -0.00113326159426583600, 
 -0.00125918568938637600,  -0.00139085424088980000, 
 -0.00152825663537017000,  -0.00167136794837955500, 
 -0.00182014869502006900,  -0.00197454462099491100, 
 -0.00213448653524230700,  -0.00229989018514782000, 
 -0.00247065617519815000,  -0.00264666992980327100, 
 -0.00282780170087432200,  -0.00301390662060243200, 
 -0.00320482479973900600,  -0.00340038147153162800, 
 -0.00360038718132193300,  -0.00380463802166317200, 
 -0.00401291591266622700,  -0.00422498892713407600, 
 -0.00444061165989654500,  -0.00465952564061029000, 
 -0.00488145978914371900,  -0.00510613091252350300, 
 -0.00533324424227905100,  -0.00556249401088406000, 
 -0.00579356406586089700,  -0.00602612851998403700, 
 -0.00625985243589418000,  -0.00649439254331473100, 
 -0.00672939798694814500,  -0.00696451110302112500, 
 -0.00719936822234543700,  -0.00743360049766550500, 
 -0.00766683475297530700,  -0.00789869435240567000, 
 -0.00812880008620923100,  -0.00835677107130444600, 
 -0.00858222566378198500,  -0.00880478238072741900, 
 -0.00902406082867291600,  -0.00923968263595819400, 
 -0.00945127238625747200,  -0.00965845855051422600, 
 -0.00986087441451983200,  -0.01005815899937536000, 
 -0.01024995797208802000,  -0.01043592454357474000, 
 -0.01061572035137586000,  -0.01078901632442047000, 
 -0.01095549352723289000,  -0.01111484398102595000, 
 -0.01126677145919164000,  -0.01141099225477229000, 
 -0.01154723591757671000,  -0.01167524595869412000, 
 -0.01179478052025484000,  -0.01190561300839013000, 
 -0.01200753268745304000,  -0.01210034523367925000, 
 -0.01218387324658887000,  -0.01225795671655838000, 
 -0.01232245344712549000,  -0.01237723943072760000, 
 -0.01242220917671699000,  -0.01245727599064251000, 
 -0.01248237220393670000,  -0.01249744935330040000,  0.98769578642927660000,
  -0.01249744935330040000,  -0.01248237220393670000, 
 -0.01245727599064251000,  -0.01242220917671699000, 
 -0.01237723943072760000,  -0.01232245344712549000, 
 -0.01225795671655838000,  -0.01218387324658887000, 
 -0.01210034523367925000,  -0.01200753268745304000, 
 -0.01190561300839013000,  -0.01179478052025484000, 
 -0.01167524595869412000,  -0.01154723591757671000, 
 -0.01141099225477229000,  -0.01126677145919164000, 
 -0.01111484398102595000,  -0.01095549352723289000, 
 -0.01078901632442047000,  -0.01061572035137586000, 
 -0.01043592454357473000,  -0.01024995797208802000, 
 -0.01005815899937536000,  -0.00986087441451983200, 
 -0.00965845855051423000,  -0.00945127238625747200, 
 -0.00923968263595819400,  -0.00902406082867291800, 
 -0.00880478238072741900,  -0.00858222566378198500, 
 -0.00835677107130444700,  -0.00812880008620923400, 
 -0.00789869435240566800,  -0.00766683475297530800, 
 -0.00743360049766550300,  -0.00719936822234543800, 
 -0.00696451110302112700,  -0.00672939798694814600, 
 -0.00649439254331473200,  -0.00625985243589418300, 
 -0.00602612851998403500,  -0.00579356406586089600, 
 -0.00556249401088406100,  -0.00533324424227905100, 
 -0.00510613091252350500,  -0.00488145978914371900, 
 -0.00465952564061029000,  -0.00444061165989654700, 
 -0.00422498892713407800,  -0.00401291591266622800, 
 -0.00380463802166317500,  -0.00360038718132193200, 
 -0.00340038147153162600,  -0.00320482479973900800, 
 -0.00301390662060243200,  -0.00282780170087432200, 
 -0.00264666992980327200,  -0.00247065617519815100, 
 -0.00229989018514782000,  -0.00213448653524230800, 
 -0.00197454462099491200,  -0.00182014869502006800, 
 -0.00167136794837955500,  -0.00152825663537017000, 
 -0.00139085424088980000,  -0.00125918568938637600, 
 -0.00113326159426583600,  -0.00101307854651154700, 
 -0.00089861944114887270,  -0.00078985384007517520, 
 -0.00068673836966793730,  -0.00058921715148209260, 
 -0.00049722226425247240,  -0.00041067423532885190, 
 -0.00032948255958947790,  -0.00025354624380472720, 
 -0.00018275437435563430,  -0.00011698670615276900, 
 -0.00005611427054948063,  -0.00000000000000000017,  0.00005150063282266088,
  0.00009853896376142908,  0.00014127247609420340,  0.00017986413197991390, 
 0.00021448169877723650,  0.00024529707257629120,  0.00027248560127034860, 
 0.00029622540947323300,  0.00031669672755894540,  0.00033408122706313300, 0.00034856136464161220,  0.00036031973672940000,  0.00036953844698482710, 
 0.00037639848853759800,  0.00038107914298735160,  0.00038375739802067220, 
 0.00038460738542994400,  0.00038379984122724600,  0.00038150158945098870, 
 0.00037787505116262130,  0.00037307778002584000,  0.00036726202575168140, 
 0.00036057432658018840,  0.00035315513185332880,  0.00034513845561499400, 
 0.00033665156205269610,  0.00032781468347236990,  0.00031874077137303890, 
 0.00030953528106237010,  0.00030029599012787860,  0.00029111285095212100, 
 0.00028206787733416070,  0.00027323506515432210,  0.00026468034689519800, 
 0.00025646157970953590,  0.00024862856660538200,  0.00024122311020115020, 
 0.00023427909838851340,  0.00022782262112960940,  0.00022187211750733490, 
 0.00021643855204390890,  0.00021152561920372840,  0.00020712997490214150, 
 0.00020324149375248640,  0.00019984355069981700 };


  *lenh0 = HP_8K_LEN;           /* store 'number of coefficients' */
  *h0 = hp_8khz_coeff;		/* store pointer to []-array */
}
#undef HP_8K_LEN
/* ...................... End of fill_fir_hp_8khz() ..................... */


/*
  ============================================================================

        SCD_FIR *fir_hp_8khz_init (void);
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

        Description:
        ~~~~~~~~~~~~

        Initialization routine for a high pass filtering 
	characteristic for data sampled at 8 kHz. 
	No rate change is implemented.

        Parameters:  none.
        ~~~~~~~~~~~

        Return value:
        ~~~~~~~~~~~~~
        Returns a pointer to struct SCD_FIR;


 ============================================================================
*/
SCD_FIR *fir_hp_8khz_init (void)
{
  float          *h0;		/* pointer to array with FIR coeff. */
  long            lenh0;	/* number of FIR coefficients */


  /* allocate array for FIR coeff. and fill with coefficients */
  fill_fir_hp_8khz(&h0, &lenh0);

  return
    fir_initialization(		/* Returns: pointer to SCD_FIR-struct */
		       lenh0,	/* In: number of FIR-coefficients */
		       h0,	/* In: pointer to array with FIR-cof. */
		       1.0,	/* In: gain factor for FIR-coeffic. */
		       1l,	/* In: Down-sampling factor */
		       'D'	/* In: switch to down-sampling proc. */
    );				/* (works here as simple FIR-fil. */
}
/* .................... End of fir_hp_8khz_init() .................... */

/* ************************** END OF FIR-P341.C *************************** */
